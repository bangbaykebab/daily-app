<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Daily Routine</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#ffffff">
  <link rel="icon" href="icons/icon-192.png" sizes="192x192">
  <style>
    body { font-family: 'Avenir', 'Segoe UI', 'Helvetica Neue', Arial, sans-serif; padding: 20px; background: #fffdf9; }
    h1 { text-align: center; font-size: 2em; margin-bottom: 10px; }
    h2 { margin-top: 30px; font-size: 1.5em; color: #333; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
    th, td { border: 1px solid #ddd; text-align: center; padding: 6px; font-size: 0.85em; }
    th { background: #f7f7f7; font-weight: bold; }
    td.time { white-space: nowrap; background: #fcfcfc; }
    td.task { text-align: left; background: #fcfcfc; }
    input[type="checkbox"] { transform: scale(1.1); }
    td.percent-cell { font-weight: bold; background: #f0f0f0; }
  </style>
</head>
<body>
<video id="introVideo" autoplay muted playsinline style="position:fixed; top:0; left:0; width:100%; height:100%; object-fit:cover; z-index:9999;">
  <source src="0730(1).mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>

  <h1>DAILY ROUTINE</h1>
  <p style="text-align: center;">Balya Ibnu Taufik</p>
  <div id="routineContainer"></div>

  <script>
    const days = Array.from({ length: 30 }, (_, i) => i + 1);
    const routines = {
      "Morning (04:30 – 12:00)": [
        ["04:30 – 05:30", "Fajr prayer, Qur’an reading"],
        ["05:30 – 07:00", "Exercise, Shower, Learn"],
        ["07:00 – 07:30", "Breakfast and drink water"],
        ["07:30 – 08:00", "Dhuha prayer"],
        ["08:00 – 10:00", "Trading"],
        ["10:00 – 12:00", "Productive activities"]
      ],
      "Afternoon (12:00 – 17:30)": [
        ["12:00 – 13:00", "Dhuhr prayer and lunch"],
        ["13:00 – 14:30", "Nap"],
        ["14:30 – 15:30", "Light productive activities"],
        ["15:30 – 16:00", "Asr prayer"],
        ["16:00 – 16:30", "Shower"],
        ["16:30 – 18:00", "Relaxation or self-reflection"]
      ],
      "Evening (18:30 – 21:30)": [
        ["18:30 – 19:30", "Maghrib prayer and dinner"],
        ["19:30 – 20:00", "Isha prayer"],
        ["20:00 – 21:00", "Daily journaling, Relaxation"],
        ["21:00 – 21:30", "Relaxation without gadgets"],
        ["21:30 – 02:30", "Night sleep"],
        ["02:30 – 03:00", "Night prayer"],
        ["03:00 – 04:30", "Continue sleeping"]
      ]
    };

    const savedChecks = JSON.parse(localStorage.getItem('dailyRoutineChecks') || '{}');
    const container = document.getElementById('routineContainer');

    Object.entries(routines).forEach(([title, activities]) => {
      const section = document.createElement('section');
      const h2 = document.createElement('h2');
      h2.textContent = title;
      section.appendChild(h2);

      const table = document.createElement('table');
      const thead = document.createElement('thead');
      const headRow = document.createElement('tr');
      headRow.innerHTML = `<th>Waktu</th><th>Aktivitas</th>` + days.map(d => `<th>${d}</th>`).join('') + `<th>%</th>`;
      thead.appendChild(headRow);
      table.appendChild(thead);

      const tbody = document.createElement('tbody');
      activities.forEach(([time, task], i) => {
        const row = document.createElement('tr');
        row.innerHTML = `<td class="time">${time}</td><td class="task">${task}</td>`;

        const checkboxes = [];

        days.forEach(day => {
          const cell = document.createElement('td');
          const checkbox = document.createElement('input');
          const key = `${title}-${i}-${day}`;
          checkbox.type = 'checkbox';
          checkbox.checked = !!savedChecks[key];

          checkbox.addEventListener('change', () => {
            savedChecks[key] = checkbox.checked;
            localStorage.setItem('dailyRoutineChecks', JSON.stringify(savedChecks));
            updatePercentage();
          });

          checkboxes.push(checkbox);
          cell.appendChild(checkbox);
          row.appendChild(cell);
        });

        // Kolom Persentase
        const percentCell = document.createElement('td');
        percentCell.classList.add('percent-cell');

        const updatePercentage = () => {
          const filled = checkboxes.filter(cb => cb.checked).length;
          percentCell.textContent = Math.round((filled / days.length) * 100) + '%';
        };

        updatePercentage(); // Inisialisasi
        row.appendChild(percentCell);
        tbody.appendChild(row);
      });

      table.appendChild(tbody);
      section.appendChild(table);
      container.appendChild(section);
    });

    // PWA SW
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(() => console.log('Service Worker Registered'));
    }
	
	  const video = document.getElementById('introVideo');
	  video.onended = () => {
		video.style.display = 'none';
		document.body.style.overflow = 'auto';
	  };
  document.body.style.overflow = 'hidden'; // mencegah scroll saat intro
  </script>
</body>
</html>
