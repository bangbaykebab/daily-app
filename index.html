<!DOCTYPE html>
<html lang="id">
<head>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#4caf50">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Time Boxing Day</title>
<style>
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
        background-color: #f4f6f8;
        margin: 0;
        padding: 15px;
        text-align: center;
        color: #333;
    }
    h1 { font-size: 26px; font-weight: bold; margin-bottom: 6px; color: #222; }
    h2 { font-size: 14px; color: #666; font-style: italic; margin-top: 0; margin-bottom: 15px; }
    .table-container { overflow-x: auto; border-radius: 12px; background: #fff; box-shadow: 0 3px 12px rgba(0,0,0,0.05); }
    table { border-collapse: collapse; min-width: 900px; font-size: 15px; width: 100%; }
    th, td { padding: 10px; text-align: center; border-bottom: 1px solid #eee; }
    th { background-color: #e9f0f6; font-weight: 600; position: sticky; top: 0; z-index: 2; }
    td.text-left { text-align: left; font-weight: 600; white-space: nowrap; }
    .yellow { color: #d4a017; }
    .blue { color: #0077cc; }
    .red { color: #d13f3f; }
    .green { color: #2d9b2d; }
    input[type="checkbox"] {
        appearance: none; -webkit-appearance: none;
        width: 22px; height: 22px; border: 2px solid #bbb; border-radius: 50%;
        background-color: white; cursor: pointer; transition: all 0.2s ease;
    }
    input[type="checkbox"]:hover { border-color: #888; }
    input[type="checkbox"]:checked {
        background-color: #4caf50; border-color: #4caf50; box-shadow: 0 0 5px rgba(76,175,80,0.6);
    }
    input[type="checkbox"]:checked::after {
        content: 'âœ”'; color: white; display: block; text-align: center;
        font-size: 14px; line-height: 20px;
    }
    .persen { font-weight: bold; color: #4caf50; }
</style>
</head>
<body>

<h1>Time Boxing Day</h1>
<h2>up to grow every day</h2>

<div class="table-container">
<table>
    <thead>
        <tr>
            <th>Kegiatan</th>
            <script>
                for (let i = 1; i <= 30; i++) {
                    document.write(`<th>${i}</th>`);
                }
            </script>
            <th>%</th>
        </tr>
    </thead>
    <tbody>
        <script>
            const kegiatan = [
                { text: "Bangun sebelum fajar", class: "" },
                { text: "Baca Quran", class: "yellow" },
                { text: "Olahraga", class: "blue" },
                { text: "Rekam Latihan Berbicara", class: "red" },
                { text: "Setoran Kosakata Bahasa Inggris", class: "red" },
                { text: "Mendengarkan Podcast", class: "red" },
                { text: "Baca 10 halaman Buku", class: "blue" },
                { text: "Sholat 5 Waktu", class: "yellow" },
                { text: "Sholat Sunah (duha/tahajud)", class: "yellow" },
                { text: "Tidur sebelum Jam 11", class: "" }
            ];

            kegiatan.forEach((item, rowIndex) => {
                document.write(`<tr><td class="text-left ${item.class}">${item.text}</td>`);
                for (let i = 1; i <= 30; i++) {
                    let id = `cb-${rowIndex}-${i}`;
                    document.write(`<td><input type="checkbox" id="${id}" onchange="hitungPersen(this);simpanData();"></td>`);
                }
                document.write(`<td class="persen">0%</td></tr>`);
            });
        </script>
    </tbody>
</table>
</div>

<script>
function hitungPersen(checkbox) {
    const row = checkbox.closest("tr");
    const ceklis = row.querySelectorAll('input[type="checkbox"]');
    let jumlah = 0;
    ceklis.forEach(cb => { if (cb.checked) jumlah++; });
    const persenCell = row.querySelector(".persen");
    let persen = Math.round((jumlah / 30) * 100);
    persenCell.textContent = persen + "%";
    persenCell.style.color = persen >= 70 ? "#4caf50" : persen >= 40 ? "#ff9800" : "#d13f3f";
}

// Simpan status checkbox ke localStorage
function simpanData() {
    const semuaCheckbox = document.querySelectorAll('input[type="checkbox"]');
    const data = {};
    semuaCheckbox.forEach(cb => {
        data[cb.id] = cb.checked;
    });
    localStorage.setItem("timeBoxingData", JSON.stringify(data));
}

// Muat data saat halaman dibuka
function muatData() {
    const data = JSON.parse(localStorage.getItem("timeBoxingData") || "{}");
    Object.keys(data).forEach(id => {
        const cb = document.getElementById(id);
        if (cb) cb.checked = data[id];
    });
    // Update semua persentase
    document.querySelectorAll("tbody tr").forEach(row => {
        hitungPersen(row.querySelector('input[type="checkbox"]'));
    });
}

document.addEventListener("DOMContentLoaded", muatData);
</script>

<script>
if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js")
        .then(() => console.log("Service Worker registered"))
        .catch(err => console.error("SW registration failed:", err));
}
</script>

</body>
</html>
